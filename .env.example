# üìã Variables d'Environnement - Carthage Market Intelligence

## Frontend (.env)

```env
# ============================================
# Supabase Configuration
# ============================================
# URL de votre projet Supabase
# Format: https://[project-ref].supabase.co
VITE_SUPABASE_URL=your_supabase_project_url

# Cl√© publique (anon key) de Supabase
# Trouvable dans: Supabase Dashboard > Settings > API
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

## Backend - Supabase Edge Functions

### Configuration via CLI

```bash
# D√©finir toutes les variables secrets
supabase secrets set AZURE_OPENAI_API_KEY="your_azure_openai_api_key"
supabase secrets set AZURE_ENDPOINT="https://iheccarthage-resource.openai.azure.com/"
supabase secrets set AZURE_DEPLOYMENT="gpt-5.2-chat"
supabase secrets set AZURE_API_VERSION="2024-02-15-preview"
supabase secrets set FIRECRAWL_API_KEY="your_firecrawl_api_key"

# V√©rifier les secrets configur√©s
supabase secrets list
```

### Liste compl√®te des variables

| Variable | Requis Par | Description |
|----------|------------|-------------|
| `AZURE_OPENAI_API_KEY` | analyze-sentiment, scrape-tradingview, generate-recommendations | Cl√© API Azure OpenAI |
| `AZURE_ENDPOINT` | analyze-sentiment, scrape-tradingview, generate-recommendations | URL de base Azure OpenAI |
| `AZURE_DEPLOYMENT` | analyze-sentiment, scrape-tradingview, generate-recommendations | Nom du d√©ploiement GPT-5.2 |
| `AZURE_API_VERSION` | analyze-sentiment, scrape-tradingview, generate-recommendations | Version de l'API Azure (2024-02-15-preview) |
| `FIRECRAWL_API_KEY` | scrape-google-news, scrape-tradingview | Cl√© API Firecrawl pour scraping |
| `SUPABASE_URL` | Toutes les fonctions | URL Supabase (auto-inject√©e) |
| `SUPABASE_SERVICE_ROLE_KEY` | Toutes les fonctions | Cl√© service role (auto-inject√©e) |

## Obtenir les Cl√©s API

### 1. Azure OpenAI

1. Cr√©er une ressource Azure OpenAI : https://portal.azure.com/
2. D√©ployer le mod√®le `gpt-5.2-chat`
3. R√©cup√©rer :
   - **API Key** : Keys and Endpoint > KEY 1
   - **Endpoint** : Keys and Endpoint > Endpoint
   - **Deployment Name** : Deployments > Nom du d√©ploiement

### 2. Firecrawl API

1. S'inscrire sur https://firecrawl.dev/
2. Cr√©er un projet
3. R√©cup√©rer la cl√© API dans le dashboard

### 3. Supabase

1. Cr√©er un projet sur https://supabase.com/
2. R√©cup√©rer :
   - **Project URL** : Settings > API > Project URL
   - **Anon Key** : Settings > API > anon public
   - **Service Role Key** : Settings > API > service_role (secret)

## Fichier .env.example (Frontend)

```env
# ============================================
# Carthage Market Intelligence - Configuration
# ============================================

# Supabase
VITE_SUPABASE_URL=https://xxxxxxxxxxxxx.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

## S√©curit√©

‚ö†Ô∏è **IMPORTANT** :
- Ne JAMAIS commit les fichiers `.env` dans Git
- Ajouter `.env` et `.env.local` dans `.gitignore`
- Utiliser des cl√©s diff√©rentes pour d√©veloppement et production
- Rotation r√©guli√®re des API keys (recommand√© tous les 3 mois)
- Ne pas exposer `SUPABASE_SERVICE_ROLE_KEY` c√¥t√© client

## V√©rification

```bash
# Frontend - V√©rifier que les variables sont charg√©es
npm run dev
# Ouvrir console navigateur : console.log(import.meta.env.VITE_SUPABASE_URL)

# Backend - Tester une Edge Function
supabase functions serve scrape-google-news
curl -X POST http://localhost:54321/functions/v1/scrape-google-news \
  -H "Authorization: Bearer YOUR_ANON_KEY" \
  -H "Content-Type: application/json" \
  -d '{"max_results": 5}'
```
